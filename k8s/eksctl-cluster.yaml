# EKS Cluster with Auto Mode
# Creates a fully managed EKS cluster with automatic compute, storage, and networking
#
# Usage: eksctl create cluster -f k8s/eksctl-cluster.yaml
apiVersion: eksctl.io/v1alpha5
kind: ClusterConfig

metadata:
  name: hackathon
  region: us-east-1
  version: "1.35"
  tags:
    Environment: dev

autoModeConfig:
  enabled: true
  # Default node pools created automatically:
  # - general-purpose: For regular workloads
  # - system: For system components
  #
  # To customize node pools, set nodePools: [] and define your own

iam:
  withOIDC: true
  podIdentityAssociations:
    - namespace: ack-system
      serviceAccountName: ack-iam-controller
      permissionPolicyARNs:
        - arn:aws:iam::aws:policy/IAMFullAccess
    - namespace: kube-system
      serviceAccountName: ebs-csi-controller-sa
      permissionPolicyARNs:
        - arn:aws:iam::aws:policy/service-role/AmazonEBSCSIDriverPolicy

addons:
  - name: aws-ebs-csi-driver
    # Required for gp3 StorageClass provisioning on EKS Auto Mode

cloudWatch:
  clusterLogging:
    enableTypes:
      - api
      - audit
      - authenticator
      - controllerManager
      - scheduler
